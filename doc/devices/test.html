<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>BioBLESS Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../frontend/test/bin/mocha.css" type="text/css">
</head>
<body>
    <div id="mocha"></div>
    <script src="../../frontend/test/bin/mocha.js" type="text/javascript"></script>
    <script src="../../frontend/test/bin/chai.js" type="text/javascript"></script>
    <script src="../../frontend/bin/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        mocha.setup('bdd');
        chai.should();
        describe('window', function() {
            it('should have property jQuery. (If this fails, the test system is error.)', function() {
                window.should.have.property('jQuery');
            });
        });
        $.ajaxSettings.async = false;
        var json;
        $.getJSON('gates_lizhi.json', function(data) {
            json = data;
        });
        describe('json', function() {
            it('should be an array. (If this fails, the file format is not a valid json.)', function() {
                json.should.be.instanceof(Array);
            });
        });
        describe('json[i]', function() {
            it('should be a proper object. (If this fails, the json is incompatible with our API.)', function() {
                for(var i = 0; i < json.length; i++) {
                    json[i].should.contain.all.keys(['id', 'input', 'output', 'parts', 'map']);
                    json[i].input.should.be.instanceof(Array);
                    json[i].output.should.be.instanceof(Array);
                    json[i].output.length.should.equal(1);
                    json[i].parts.should.contain.all.keys(['id', 'type']);
                    json[i].parts.id.should.be.instanceof(Array);
                    for(var j = 0; j < json[i].parts.id.length; j++)
                        json[i].parts.id[j].should.be.instanceof(Array);
                    json[i].map.should.be.instanceof(Array);
                    for(var j = 0; j < json[i].map.length; j++)
                        json[i].map[j].should.contain.all.keys(['id', 'id1', 'id2', 'type', 'params']);
                    json[i].type.should.contain.all.keys({'type':null,'function':null,'chassis':null,'standard':null,'contributor':null});
                }
            });
        });
    </script>
    <script type="text/javascript">
        if(window.mochaPhantomJS)
            mochaPhantomJS.run();
        else
            mocha.run();
    </script>
</body>
</html>
